
@{
    ViewBag.Title = "VideoComments";
}

<h2>@RPA_Sales.Resources.Resource.VideoComments</h2>

<div class="container">
    <br />
    <div style="width:90%; margin:0 auto;">
        <table id="VideoGridComments" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0" cellpadding="5">
            <thead>
                <tr>
                    <th>Sno</th>
                    <th>VideoId</th>
                    <th>@RPA_Sales.Resources.Resource.VideoName</th>
                    <th>@RPA_Sales.Resources.Resource.VideoComments</th>
                    <th>FilePath</th>
                    <th>@RPA_Sales.Resources.Resource.VisitedDate</th>
                    <th>@RPA_Sales.Resources.Resource.IsApproved</th>
                    <th>@RPA_Sales.Resources.Resource.ApprovedBy</th>
                    <th>@RPA_Sales.Resources.Resource.UserId</th>
                    <th>@RPA_Sales.Resources.Resource.VisitorName</th>
                    <th>FileName</th>
                    <th>IsDeleted</th>
                    <th>@RPA_Sales.Resources.Resource.View</th>
                </tr>
            </thead>
        </table>
    </div>
</div>



<div id="approvesection">

</div>


@section ScriptSection
{
    <script>

    $(document).ready(function () {
        $("#VideoGridComments").DataTable({

                "processing": true, // for show progress bar
                "serverSide": false, // for process server side
                "filter": true, // this is for disable filter (search box)
                "orderMulti": false, // for disable multiple column at once
                "pageLength": 5,

                "ajax": {

                     "url":  "@Url.Action("LoadVideoCommentsListData", "Home")",
                    "type": "POST",
                    "datatype": "json"
                },

                "columnDefs":
                    [{
                        "targets": [0],
                        "visible": false,
                        "searchable": true,
                        "orderable": true
                    },
                    {
                        "targets": [1],
                        "visible": false,
                        "searchable": true,
                        "orderable": true
                    },
                    {
                        "targets": [2],
                        "searchable": false,
                        "orderable": true
                    },
                    {
                        "targets": [3],
                        "searchable": false,
                        "orderable": false,
                        "visible": false
                    },
                    {
                        "targets": [4],
                        "searchable": false,
                        "orderable": false,
                        "visible": false
                    },
                    {
                        "targets": [5],
                        "searchable": false,
                        "orderable": false
                    },
                    {
                            "targets": [6],
                            "searchable": false,
                            "orderable": false
                    },
                    {
                            "targets": [7],
                            "searchable": false,
                            "orderable": false
                    },
                    {
                            "targets": [8],
                            "searchable": false,
                            "orderable": false
                    },
                    {
                            "targets": [9],
                            "searchable": false,
                            "orderable": false
                   },

                   {
                            "targets": [10],
                            "searchable": false,
                            "orderable": false,
                            "visible": false
                   },
                   {
                            "targets": [11],
                            "searchable": false,
                            "orderable": false,
                            "visible": false
                    },
                    {
                            "targets": [12],
                            "searchable": false,
                            "orderable": false
                    }

                    ],


            "columns": [
                    { "data": "Sno", "name": "Sno", "autoWidth": true },
                    { "data": "VideoId", "name": "VideoId", "autoWidth": true },
                    { "data": "VideoName", "name": "VideoName", "autoWidth": true },
                    { "data": "VideoComments", "name": "VideoComments", "autoWidth": true },
                
                    { "data": "FilePath", "name": "FilePath", "autoWidth": true },
                    { "data": "VisitedDate", "name": "VisitedDate", "autoWidth": true },

                    { "data": "IsApproved", "name": "IsApproved", "autoWidth": true },
                    { "data": "ApprovedBy", "name": "ApprovedBy", "autoWidth": true },
                    { "data": "UserId", "name": "UserId", "autoWidth": true },
                    { "data": "VisitorName", "name": "VisitorName", "autoWidth": true },
                { "data": "FileName", "name": "FileName", "autoWidth": true },
                { "data": "IsDeleted", "name": "IsDeleted", "autoWidth": true },
                {
                    
                    "render": function (data, type, row, meta) {

                        //return '<a class="btn btn-info" href="javascript:void(0);" onclick="ShowComments(' + "'" + row.Sno + "','" + row.IsDeleted + "','" + row.IsApproved + "','" + row.VideoName + "','" + encodeURI(row.VideoComments) + "','" + row.FileName + "'" + ')">Approve</a>';
                        return '<button class="btn btn-info" onclick="ShowComments(' + "'" + row.Sno + "','" + row.IsDeleted + "','" + row.IsApproved + "','" + row.VideoName + "','" + row.VideoComments + "','" + row.FileName + "'" + ')">@RPA_Sales.Resources.Resource.Approve</button>';

                    }

               },
                ]

        });

         $(document).on('click', '.btnapprovalcomments', function () {
        
            var Sno = $('#Sno').val();
            var IsApproved = $('#IsApproved').val();

                $.ajax({
                    url: '@Url.Action("SaveVideoApprove", "Home")',
                    type: 'POST',
                    data: { 'Sno': Sno, 'IsApproved': IsApproved },
                    success: function (result) {

                        if (result.errorcode == 0) {
                            $('#approvesection').html('')
                            alert('@RPA_Sales.Resources.Resource.ApproveUpdatedSuccessfully');
                            RefreshDataTable();
                        }
                        else {
                            alert('@RPA_Sales.Resources.Resource.ApproveUpdationFailed.');
                        }
                    },
                    error: function (error) {
                        console.log(error);
                    }

                });
        });




        $(document).on('click', '.btnrejectedcomments', function () {
          
            var Sno = $('#Sno').val();
            var IsDeleted = $('#IsDeleted').val();

                $.ajax({
                    url: '@Url.Action("RejectVideoApprove", "Home")',
                    type: 'POST',
                    data: { 'Sno': Sno, 'IsDeleted': IsDeleted },
                    success: function (result) {

                        if (result.errorcode == 0) {
                            $('#approvesection').html('')
                            alert('@RPA_Sales.Resources.Resource.RejectedUpdationSuccessfully');
                            RefreshDataTable();
                        }
                        else {
                            alert('@RPA_Sales.Resources.Resource.RejectUpdationFailed');
                        }
                    },
                    error: function (error) {
                        console.log(error);
                    }

                });
            });




    });

        function RefreshDataTable() {
            $('#VideoGridComments').DataTable().ajax.reload(null, false);
            $("#VideoGridComments").DataTable().page('first').draw('page');

        }

        function ShowComments(Sno,IsDeleted,IsApproved,VideoName,VideoComments,FileName) {
            $.ajax({
                url: '@Url.Action("ShowVideoComments", "Home")',
                type: 'POST',
                data: {
                    'Sno': Sno, 'IsDeleted': IsDeleted, 'IsApproved': IsApproved, 'VideoName': VideoName, 'VideoComments': VideoComments, 'FileName': FileName
                    },
                    success: function (result) {
                      
                        $('#approvesection').html(result)
                        
                    },
                    error: function (error) {
                        console.log(error);
                    }

                });
        }



    </script>

}